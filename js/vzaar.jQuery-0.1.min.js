function vzInit(e){return new vzPlayer(e)}function vzEmbed(e){var t="http://view.vzaar.com/"+e.newId+"/player?apiOn=true&autoplay=true&"+e.flashvars;$("#"+e.id).parent().fadeOut("slow").promise().done(function(){$("#"+e.id).attr("src",t);$(this).delay(2e3).fadeIn("slow")})}function timeConvert(e){if(isNaN(e)){e=0}var t=parseInt(e);mins=Math.floor(t/60).toString();secs=(t%60).toString();if(mins.length===1){mins="0"+mins}if(secs.length===1){secs="0"+secs}return mins+":"+secs}(function(e){"use strict";e.fn.vzPrerollinator=function(t){var n=this,r=n.attr("id").match(/\d{1,7}/)[0],i=e.extend({pre:"958317",prerollDone:false,mainDone:false,prevars:"",mainvars:""},t);this.queue(function(){setTimeout(function(){var e=vzInit(n.attr("id"));e.ready(function(){e.addEventListener("playState",function(e){if(e=="mediaStarted"&&!i.prerollDone){var t={id:n.attr("id"),newId:i.pre,flashvars:i.prevars};vzEmbed(t);i.prerollDone=true}else if(e=="mediaEnded"&&!i.mainDone){var t={id:n.attr("id"),newId:r,flashvars:i.mainvars};vzEmbed(t);i.mainDone=true;n.dequeue()}})})},500)});return this};e.fn.vzPostrollinator=function(t){var n=this,r=n.attr("id").match(/\d{1,7}/)[0],i=e.extend({post:"958317",postvars:"",mainDone:false},t);this.queue(function(){setTimeout(function(){var e=vzInit(n.attr("id"));e.ready(function(){e.addEventListener("playState",function(e){if(e=="mediaEnded"&&!i.mainDone){var t={id:n.attr("id"),newId:i.post,flashvars:i.postvars};vzEmbed(t);i.mainDone=true;n.dequeue()}})})},500)});return this};e.fn.vzBookmarkifier=function(t){var n=this,r=0,i=e(n),s=e.extend({persistent:false,message:"Really? :("},t);var o=vzInit(n.attr("id"));i.after('<div class="vzBookmark"><a href="#" class="vzAddBookmark">Add Bookmark</a> | <a href="#" class="vzResetBookmark">Reset Bookmark</a> | Current bookmark: <span class="vzCurrentBookmark">00:00</span></div>');o.ready(function(){function t(t){e.cookie("bookmark",t,{expires:1});t=t.toString();e(".vzCurrentBookmark").html(timeConvert(t))}o.addEventListener("playState",function(t){if(t=="mediaStarted"){o.seekTo(e.cookie("bookmark"))}});if(!e.cookie("bookmark")){r=0}else{r=e.cookie("bookmark").toString()}if(r.length==1){r="&nbsp;"+r}e(".vzCurrentBookmark").html(timeConvert(r));e(".vzAddBookmark").on("click",function(){o.getTime(function(e){if(isNaN(e)){e=0}t(e)})});e(".vzResetBookmark").on("click",function(){e.cookie("bookmark",0);t(0)});if(s.persistent){window.onbeforeunload=function(){o.getTime(function(e){if(isNaN(e)){e=0}t(e)});return s.message}}});return this};e.fn.vzChapterizer=function(t){var n=this,r=e(n),i=0,s=0,o=false,u=e.extend({appendTimes:false,chapters:[],titles:[],orientation:"vertical",position:"right",chapterNumbers:false},t);var a=vzInit(n.attr("id")),f=u.chapters,l=u.titles,c=[];if(f[0]!==0){f.unshift(0);l.unshift("Please add a bookmark at 0 seconds")}r.wrap('<div class="vzContainer" />');if(u.position==="top"||u.position==="left"){r.before('<ul id="vzChapters"></ul>')}else if(u.position==="bottom"||u.position==="right"){r.after('<ul id="vzChapters"></ul>')}e("#vzChapters").addClass(u.orientation).addClass(u.position);e.each(u.titles,function(e,t){if(u.chapterNumbers){c.push("<li>"+(e+1)+'. <a href="#">'+t+"</a></li>")}else{c.push('<li><a href="#">'+t+"</a></li>")}});e("#vzChapters").append(c.join(""));if(u.position==="left"||u.position==="right"){e(".vzContainer").css("width",function(){return e("#vzChapters").outerWidth()+(r.attr("width")*1+8)})}var h=e("#vzChapters li");h.first().addClass("current");if(u.appendTimes){h.each(function(t){e(this).append(' <span class="vzChaptersAppendTimes">'+timeConvert(f[t])+"</span>")})}a.ready(function(){function t(){a.getTime(function(e){n.data("time",e)});if(l(n.data("time"))){o=false;h.removeClass("current").eq(s).addClass("current")}}function r(e){if(e=="pause"){clearInterval(i)}else if(e=="resume"){i=setInterval(t,1e3)}}function u(e){if(e=="mediaStarted"){i=setInterval(t,1e3)}else if(e=="mediaEnded"){clearInterval(i)}}function l(e){if(f[s+1]<e){o=true;s++;l(e)}else if(f[s]>e){o=true;s--;l(e)}else{return o}}a.addEventListener("playState",function(e){u(e)});a.addEventListener("interaction",function(e){r(e)});h.on("click",function(n){a.play2();a.seekTo(f[h.index(e(this))]);clearInterval(i);i=setInterval(t,1e3);n.preventDefault()})});return this};e.fn.vzPlaycountattacher=function(t){var n=this,r=n.attr("id").match(/\d{1,7}/)[0],i="http://vzaar.com/api/videos/"+r+".json?callback=?";e.getJSON(i,function(t){if(t){var r=t.play_count===1?t.play_count+" play":t.play_count+" plays";e(n).after('<div class="vzPlaycount">'+r+"</div>")}});return this}})(jQuery);(function(e,t,n){function i(e){return e}function s(e){return decodeURIComponent(e.replace(r," "))}var r=/\+/g;var o=e.cookie=function(r,u,a){if(u!==n){a=e.extend({},o.defaults,a);if(u===null){a.expires=-1}if(typeof a.expires==="number"){var f=a.expires,l=a.expires=new Date;l.setDate(l.getDate()+f)}u=o.json?JSON.stringify(u):String(u);return t.cookie=[encodeURIComponent(r),"=",o.raw?u:encodeURIComponent(u),a.expires?"; expires="+a.expires.toUTCString():"",a.path?"; path="+a.path:"",a.domain?"; domain="+a.domain:"",a.secure?"; secure":""].join("")}var c=o.raw?i:s;var h=t.cookie.split("; ");for(var p=0,d;d=h[p]&&h[p].split("=");p++){if(c(d.shift())===r){var v=c(d.join("="));return o.json?JSON.parse(v):v}}return null};o.defaults={};e.removeCookie=function(t,n){if(e.cookie(t)!==null){e.cookie(t,null,n);return true}return false}})(jQuery,document)
